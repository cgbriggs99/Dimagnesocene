import math
memory 24 GB
set reference uhf

molecule becp {
    -1 2

 C    3.529263326511    0.944622912518   -0.747874327108
 C    3.543618717823    0.941541389924    0.677471493528
 C    3.520999189130   -0.416807435453    1.116436993198
 C    3.514121908898   -1.254689463613   -0.041848180385
 C    3.514671424060   -0.415429992965   -1.192579189642
 C   -3.522473139595    1.032398657916   -0.652612727325
 C   -3.502768303230    1.013230556311    0.772563181329
 C   -3.502431531298   -0.350309867731    1.195966074358
 C   -3.543529588443   -1.174653364032    0.028900350832
 C   -3.551175001955   -0.322491721738   -1.112279638843
 H    3.537333218439    1.830345562135   -1.387630235123
 H    3.533641206668    1.823773147372    1.320373093643
 H    3.529803854757   -0.756318176713    2.155213350190
 H    3.484792374957   -2.346187779968   -0.044923026617
 H    3.499116697117   -0.752165874691   -2.231578645641
 H   -3.524241998040    1.925430178280   -1.282174704655
 H   -3.456467627697    1.887592334746    1.424571201230
 H   -3.494395786133   -0.701339902546    2.230917124029
 H   -3.539919981816   -2.266419755434    0.013326891208
 H   -3.568749425294   -0.647403799480   -2.155015919446
Mg    1.356035011353   -0.015526574338   -0.027046340616
Mg   -1.356221948546    0.016934747575    0.003150422864
}

set SCF_INITIAL_ACCELERATOR NONE
set CACHELEVEL 1

prefix = "out/magnesium/wB97X-V/dimagnesocene-"


E, wfn = optimize("WB97X-V/cc-pVDZ", return_wfn = True)

becp.save_xyz_file(prefix + ".xyz", True)

wfn.to_file(prefix + ".wf")
fchk(wfn, prefix + ".fchk")

fstr = ""
with open(prefix + ".xyz", "r") as fp :
    for line in fp :
        newline = line[0]
        for i in range(1, len(line)) :
            if line[i - 1].isupper() and line[i].isupper() :
                newline += line[i].lower()
            else :
                newline += line[i]
        fstr += newline

with open(prefix + ".xyz", "w") as fp :
    print(fstr, file = fp)
