import math

memory 24 GB
set reference uhf

molecule becp {
    1 2
    symmetry c1
 C    3.520041068328    0.951059360315   -0.691822067774
 C    3.528728753839    0.950704932114    0.744654253057
 C    3.544956838476   -0.415696912437    1.188260282179
 C    3.546289642468   -1.259843200765    0.025534974539
 C    3.530882127737   -0.414890796740   -1.136344799375
 C   -3.518678628060    1.038091405742   -0.750586280552
 C   -3.527294248607    1.037643816545    0.686117211632
 C   -3.545431503095   -0.328720535312    1.129505140694
 C   -3.548022926297   -1.172745806222   -0.032951956157
 C   -3.531486413820   -0.328129837606   -1.194958243308
 H    3.565260746902    1.834123639854   -1.332859425744
 H    3.582220754432    1.833275119523    1.385741839283
 H    3.613851495814   -0.752495458572    2.224900085293
 H    3.616403923913   -2.349744510872    0.024827953398
 H    3.586347444264   -0.751098192775   -2.173974070021
 H   -3.563785821796    1.921161995048   -1.391637753993
 H   -3.579842027907    1.920379685330    1.327059285167
 H   -3.613842679593   -0.665313934803    2.166235247668
 H   -3.618776977013   -2.262597746786   -0.033694042806
 H   -3.587826179556   -0.664175687211   -2.232595528574
Mg    1.597643220767   -0.059774829107    0.039698304929
Mg   -1.597636020223    0.028351868410   -0.021879870023

}

set SCF_INITIAL_ACCELERATOR NONE
set CACHELEVEL 1

prefix = "out/magnesium/M06-2X/dimagnesocene+"


E, wfn = optimize("M06-2X/cc-pVDZ", return_wfn = True)

becp.save_xyz_file(prefix + ".xyz", True)

wfn.to_file(prefix + ".wf")
fchk(wfn, prefix + ".fchk")

fstr = ""
with open(prefix + ".xyz", "r") as fp :
    for line in fp :
        newline = line[0]
        for i in range(1, len(line)) :
            if line[i - 1].isupper() and line[i].isupper() :
                newline += line[i].lower()
            else :
                newline += line[i]
        fstr += newline

with open(prefix + ".xyz", "w") as fp :
    print(fstr, file = fp)


