
    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                               Psi4 1.8.1 release

                         Git: Rev {} zzzzzzz 


    D. G. A. Smith, L. A. Burns, A. C. Simmonett, R. M. Parrish,
    M. C. Schieber, R. Galvelis, P. Kraus, H. Kruse, R. Di Remigio,
    A. Alenaizan, A. M. James, S. Lehtola, J. P. Misiewicz, M. Scheurer,
    R. A. Shaw, J. B. Schriber, Y. Xie, Z. L. Glick, D. A. Sirianni,
    J. S. O'Brien, J. M. Waldrop, A. Kumar, E. G. Hohenstein,
    B. P. Pritchard, B. R. Brooks, H. F. Schaefer III, A. Yu. Sokolov,
    K. Patkowski, A. E. DePrince III, U. Bozkaya, R. A. King,
    F. A. Evangelista, J. M. Turney, T. D. Crawford, C. D. Sherrill,
    J. Chem. Phys. 152(18) 184108 (2020). https://doi.org/10.1063/5.0006002

                            Additional Code Authors
    E. T. Seidl, C. L. Janssen, E. F. Valeev, M. L. Leininger,
    J. F. Gonthier, R. M. Richard, H. R. McAlexander, M. Saitow, X. Wang,
    P. Verma, M. H. Lechner, A. Jiang, S. Behnle, A. G. Heide,
    M. F. Herbst, and D. L. Poole

             Previous Authors, Complete List of Code Contributors,
                       and Citations for Specific Modules
    https://github.com/psi4/psi4/blob/master/codemeta.json
    https://github.com/psi4/psi4/graphs/contributors
    http://psicode.org/psi4manual/master/introduction.html#citing-psifour

    -----------------------------------------------------------------------


    Psi4 started on: Thursday, 24 August 2023 08:25AM

    Process ID: 16417
    Host:       connor-LIFEBOOK-T937
    PSIDATADIR: /home/connor/miniconda3/envs/p4env/share/psi4
    Memory:     500.0 MiB
    Threads:    4
    
  ==> Input File <==

--------------------------------------------------------------------------
import math
import os
import time
import pickle

# Minimal geometry from experiment.

becp = geometry("""
0 1
symmetry c1

Be 6.07874 2.45740 2.20602
Be 7.89690 2.43374 3.14396
C 8.72687 2.56070 4.91891
H 8.17652 2.68889 5.84031
C 9.17774 3.60056 4.06841
H 9.03081 4.65933 4.22871
C 9.76230 3.00649 2.92240
H 10.13855 3.53358 2.05701
C 9.67272 1.59945 3.06466
H 9.96894 0.86746 2.32660
C 9.03279 1.32392 4.29858
H 8.75633 0.34533 4.66493
C 5.19099 3.05518 0.55978
H 5.69006 3.57212 -0.24768
C 5.09296 1.64977 0.71226
H 5.50429 0.90896 0.04123
C 4.45261 1.38708 1.94876
H 4.29105 0.41114 2.38432
C 4.15477 2.63011 2.56046
H 3.72671 2.76661 3.54352
C 4.61116 3.66102 1.70205
H 4.59148 4.72016 1.91681
""")

# Convert to bohr first. This fixes unit issues that Psi4 seems to have.
becp.set_units(psi4.core.Bohr)
ideal_bebe = becp.xyz(0).distance(becp.xyz(1))
ideal_bec = min(becp.xyz(0).distance(becp.xyz(2)),
                becp.xyz(1).distance(becp.xyz(2)))
# Convert back.
becp.set_units(psi4.core.Angstrom)

methods = ["hf", "mp2", "b3lyp", "b97-1", "pw6b95", "cisd", "ccsd", "dsd-b3lyp-d3bj"]

basis = "cc-pVDZ"
method = methods[int(os.environ["SGE_TASK_ID"]) - 1]
# First test, energies.
start_time = time.time()
en = energy(method + "/" + basis)
ideal_en = -416.31749560

# Second test, optimized structure.
try :
    optimize(method + "/" + basis)
except Exception as e :
    task_id = os.environ["SGE_TASK_ID"]
    while os.path.isfile("out/lock.methods.txt") :
        time.sleep(0.3)
    
    with open("out/lock.methods.txt", "w+") as _ :
        with open("out/lock.methods.txt", "a+") as fp :
            print(f"Method {method}/{basis} did not converge!", file = fp)
    os.remove("out/lock.methods.txt")
    os.rename("in/be_bond_compare.out", f"out/be_bond_compare-{task_id}.out")
    raise e

end_time = time.time()

# Find the bond lengths. Set to bohr to fix units.
becp.set_units(psi4.core.Bohr)
bebe = becp.xyz(0).distance(becp.xyz(1))
bec = min(becp.xyz(0).distance(becp.xyz(2)),
          becp.xyz(1).distance(becp.xyz(2)))

# Report these in a file, along with their differences.
while os.path.isfile("out/lock.methods.dat") :
    time.sleep(0.3)

# Obtain a lock and write lines to file.
with open("out/lock.methods.dat", "w+") as _ :
    with open("out/methods.dat", "ba+") as fp :
        fp.write(pickle.dumps([en, bebe, bec,
                               en - ideal_en, bebe - ideal_bebe,
                               bec - ideal_bec, end_time - start_time, method]))
        fp.write(b'\n')
# Release the lock.        
os.remove("out/lock.methods.dat")
        

--------------------------------------------------------------------------

Scratch directory: /tmp/
   => Libint2 <=

    Primary   basis highest AM E, G, H:  5, 4, 3
    Auxiliary basis highest AM E, G, H:  6, 5, 4
    Onebody   basis highest AM E, G, H:  6, 5, 4
    Solid Harmonics ordering:            gaussian

*** tstart() called on connor-LIFEBOOK-T937
*** at Thu Aug 24 08:25:54 2023

   => Loading Basis Set <=

    Name: CC-PVDZ
    Role: ORBITAL
    Keyword: BASIS
    atoms 1-2                                 entry BE         line    75 file /home/connor/miniconda3/envs/p4env/share/psi4/basis/cc-pvdz.gbs 
    atoms 3, 5, 7, 9, 11, 13, 15, 17, 19, 21  entry C          line   138 file /home/connor/miniconda3/envs/p4env/share/psi4/basis/cc-pvdz.gbs 
    atoms 4, 6, 8, 10, 12, 14, 16, 18, 20, 22 entry H          line    22 file /home/connor/miniconda3/envs/p4env/share/psi4/basis/cc-pvdz.gbs 


         ---------------------------------------------------------
                                   SCF
               by Justin Turney, Rob Parrish, Andy Simmonett
                          and Daniel G. A. Smith
                              RKS Reference
                        4 Threads,    500 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c1
    Full point group: C1

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
         BE          -0.908789883082     0.010202885521    -0.469526005401     9.012183065000
         BE           0.909370116918    -0.013457114479     0.468413994599     9.012183065000
         C            1.739340116918     0.113502885521     2.243363994599    12.000000000000
         H            1.188990116918     0.241692885521     3.164763994599     1.007825032230
         C            2.190210116918     1.153362885521     1.392863994599    12.000000000000
         H            2.043280116918     2.212132885521     1.553163994599     1.007825032230
         C            2.774770116918     0.559292885521     0.246853994599    12.000000000000
         H            3.151020116918     1.086382885521    -0.618536005401     1.007825032230
         C            2.685190116918    -0.847747114479     0.389113994599    12.000000000000
         H            2.981410116918    -1.579737114479    -0.348946005401     1.007825032230
         C            2.045260116918    -1.123277114479     1.623033994599    12.000000000000
         H            1.768800116918    -2.101867114479     1.989383994599     1.007825032230
         C           -1.796539883082     0.607982885521    -2.115766005401    12.000000000000
         H           -1.297469883082     1.124922885521    -2.923226005401     1.007825032230
         C           -1.894569883082    -0.797427114479    -1.963286005401    12.000000000000
         H           -1.483239883082    -1.538237114479    -2.634316005401     1.007825032230
         C           -2.534919883082    -1.060117114479    -0.726786005401    12.000000000000
         H           -2.696479883082    -2.036057114479    -0.291226005401     1.007825032230
         C           -2.832759883082     0.182912885521    -0.115086005401    12.000000000000
         H           -3.260819883082     0.319412885521     0.867973994599     1.007825032230
         C           -2.376369883082     1.213822885521    -0.973496005401    12.000000000000
         H           -2.396049883082     2.272962885521    -0.758736005401     1.007825032230

  Running in c1 symmetry.

  Rotational constants: A =      0.07428  B =      0.01703  C =      0.01703 [cm^-1]
  Rotational constants: A =   2226.91551  B =    510.41593  C =    510.41532 [MHz]
  Nuclear repulsion =  530.991458653511927

  Charge       = 0
  Multiplicity = 1
  Electrons    = 78
  Nalpha       = 39
  Nbeta        = 39

  ==> Algorithm <==

  SCF Algorithm Type is DF.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is SAD.
  Energy threshold   = 1.00e-06
  Density threshold  = 1.00e-06
  Integral threshold = 1.00e-12

  ==> Primary Basis <==

  Basis Set: CC-PVDZ
    Blend: CC-PVDZ
    Number of shells: 102
    Number of basis functions: 218
    Number of Cartesian functions: 230
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> DFT Potential <==

   => LibXC <=

    Version 6.2.2
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1â€“5 (2018) (10.1016/j.softx.2017.11.002)

   => Composite Functional: B97-1 <= 

    B97-1 Hyb-GGA Exchange-Correlation Functional

    F. A. Hamprecht, A. J. Cohen, D. J. Tozer, and N. C. Handy.,  J. Chem. Phys. 109, 6264 (1998) (10.1063/1.477267)

    Deriv               =              1
    GGA                 =           TRUE
    Meta                =          FALSE

    Exchange Hybrid     =           TRUE
    MP2 Hybrid          =          FALSE

   => Exchange-Correlation Functionals <=

    1.0000       Becke 97-1

   => Exact (HF) Exchange <=

    0.2100               HF 

   => LibXC Density Thresholds  <==

    XC_HYB_GGA_XC_B97_1:  1.00E-14 

   => Molecular Quadrature <=

    Radial Scheme          =       TREUTLER
    Pruning Scheme         =           NONE
    Nuclear Scheme         =       TREUTLER

    Blocking Scheme        =         OCTREE
    BS radius alpha        =              1
    Pruning alpha          =              1
    Radial Points          =             75
    Spherical Points       =            302
    Total Points           =         458737
    Total Blocks           =           3357
    Max Points             =            256
    Max Functions          =            215
    Weights Tolerance      =       1.00E-15

   => Loading Basis Set <=

    Name: (CC-PVDZ AUX)
    Role: JKFIT
    Keyword: DF_BASIS_SCF
    atoms 1-2                                 entry BE         line    96 file /home/connor/miniconda3/envs/p4env/share/psi4/basis/def2-universal-jkfit.gbs 
    atoms 3, 5, 7, 9, 11, 13, 15, 17, 19, 21  entry C          line   121 file /home/connor/miniconda3/envs/p4env/share/psi4/basis/cc-pvdz-jkfit.gbs 
    atoms 4, 6, 8, 10, 12, 14, 16, 18, 20, 22 entry H          line    51 file /home/connor/miniconda3/envs/p4env/share/psi4/basis/cc-pvdz-jkfit.gbs 

  ==> Integral Setup <==

  DFHelper Memory: AOs need 0.342 GiB; user supplied 0.342 GiB. 
  Using in-core AOs.

  ==> MemDFJK: Density-Fitted J/K Matrices <==

    J tasked:                   Yes
    K tasked:                   Yes
    wK tasked:                   No
    OpenMP threads:               4
    Memory [MiB]:               350
    Algorithm:                 Core
    Schwarz Cutoff:           1E-12
    Mask sparsity (%):      10.9671
    Fitting Condition:        1E-10

   => Auxiliary Basis Set <=

  Basis Set: (CC-PVDZ AUX)
    Blend: CC-PVDZ-JKFIT + DEF2-UNIVERSAL-JKFIT
    Number of shells: 364
    Number of basis functions: 1032
    Number of Cartesian functions: 1180
    Spherical Harmonics?: true
    Max angular momentum: 3

  Cached 1.3% of DFT collocation blocks in 0.027 [GiB].

  Minimum eigenvalue in the overlap matrix is 4.7957601107E-04.
  Reciprocal condition number of the overlap matrix is 6.0641028956E-05.
    Using symmetric orthogonalization.

  ==> Pre-Iterations <==

  SCF Guess: Superposition of Atomic Densities via on-the-fly atomic UHF (no occupation information).

   -------------------------
    Irrep   Nso     Nmo    
   -------------------------
     A        218     218 
   -------------------------
    Total     218     218
   -------------------------

  ==> Iterations <==

                           Total Energy        Delta E     RMS |[F,P]|

   @DF-RKS iter SAD:  -416.65990643055636   -4.16660e+02   0.00000e+00 

    Psi4 stopped on: Thursday, 24 August 2023 08:26AM
    Psi4 wall time for execution: 0:00:08.54

*** Psi4 encountered an error. Buy a developer more coffee!
*** Resources and help at github.com/psi4/psi4.
